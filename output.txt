 random seed
{'arch': 'timm_vit_base_patch16_224',
 'base_mode': 'ft_cos',
 'batch_size_base': 128,
 'batch_size_new': 0,
 'dataroot': 'data/',
 'dataset': 'cifar100',
 'debug': False,
 'decay': 0.0005,
 'episode_query': 15,
 'episode_shot': 1,
 'episode_way': 15,
 'epochs_base': 10,
 'epochs_new': 1000,
 'flag': '',
 'gamma': 0.1,
 'gpu': '0',
 'log_dir': './tensorboard',
 'low_shot': 1,
 'low_way': 15,
 'lr_base': 1e-05,
 'lr_new': 0.1,
 'lrg': 0.1,
 'milestones': [30, 70, 150, 300],
 'min_lr': 1e-08,
 'model_dir': None,
 'momentum': 0.9,
 'new_mode': 'ft_cos',
 'not_data_init': False,
 'num_workers': 32,
 'project': 'base',
 'schedule': 'Milestone',
 'seed': 0,
 'set_no_val': False,
 'start_session': 0,
 'step': 40,
 'temperature': 16,
 'test_batch_size': 100,
 'train_episode': 50,
 'warmup_rate': 0.5}
use gpu: [0]
Model = DataParallel(
  (module): MYNET(
    (backbone): VisionTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16))
      )
      (pos_drop): Dropout(p=0, inplace=False)
      (blocks): ModuleList(
        (0-11): 12 x Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop): Dropout(p=0, inplace=False)
          )
          (tanh): Tanh()
        )
      )
      (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (tanh): Tanh()
      (head): Linear(in_features=768, out_features=1000, bias=True)
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (activation): Tanh()
    (ln): LayerNorm((1000,), eps=1e-05, elementwise_affine=True)
    (fc): Linear(in_features=1000, out_features=100, bias=False)
  )
)
random init params
Model = DataParallel(
  (module): MYNET(
    (backbone): VisionTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16))
      )
      (pos_drop): Dropout(p=0, inplace=False)
      (blocks): ModuleList(
        (0-11): 12 x Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop): Dropout(p=0, inplace=False)
          )
          (tanh): Tanh()
        )
      )
      (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (tanh): Tanh()
      (head): Linear(in_features=768, out_features=1000, bias=True)
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (activation): Tanh()
    (ln): LayerNorm((1000,), eps=1e-05, elementwise_affine=True)
    (fc): Linear(in_features=1000, out_features=100, bias=False)
  )
)
random init params
FLOPs(million):  17582.845224
parameters:  | name                           | #elements or shape   |
|:-------------------------------|:---------------------|
| model                          | 86.7M                |
|  module                        |  86.7M               |
|   module.backbone              |   86.6M              |
|    module.backbone.cls_token   |    (1, 1, 768)       |
|    module.backbone.pos_embed   |    (1, 197, 768)     |
|    module.backbone.patch_embed |    0.6M              |
|    module.backbone.blocks      |    85.1M             |
|    module.backbone.norm        |    1.5K              |
|    module.backbone.head        |    0.8M              |
|   module.ln                    |   2.0K               |
|    module.ln.weight            |    (1000,)           |
|    module.ln.bias              |    (1000,)           |
|   module.fc                    |   100.0K             |
|    module.fc.weight            |    (100, 1000)       |
Files already downloaded and verified
new classes for this session:
 [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47
 48 49 50 51 52 53 54 55 56 57 58 59]
epo 0, test, loss=4.2023 acc=0.0298
********A model is found!!**********
Saving model to :checkpoint/cifar100/base/ft_cos-ft_cos-data_init-start_0/-T_16.00-ftLR_0.100-ftEpoch_1000/0.pth
********A better model is found!!**********
Saving model to :checkpoint/cifar100/base/ft_cos-ft_cos-data_init-start_0/-T_16.00-ftLR_0.100-ftEpoch_1000/session0_max_acc.pth
best epoch 0, best test acc=2.983
This epoch takes 105 seconds 
still need around 28.25 mins to finish this session
epo 1, test, loss=3.9189 acc=0.0827
********A better model is found!!**********
Saving model to :checkpoint/cifar100/base/ft_cos-ft_cos-data_init-start_0/-T_16.00-ftLR_0.100-ftEpoch_1000/session0_max_acc.pth
best epoch 1, best test acc=8.267
This epoch takes 89 seconds 
still need around 22.28 mins to finish this session
epo 2, test, loss=3.4084 acc=0.2623
********A better model is found!!**********
Saving model to :checkpoint/cifar100/base/ft_cos-ft_cos-data_init-start_0/-T_16.00-ftLR_0.100-ftEpoch_1000/session0_max_acc.pth
best epoch 2, best test acc=26.233
This epoch takes 88 seconds 
still need around 20.73 mins to finish this session
epo 3, test, loss=2.5964 acc=0.5532
********A better model is found!!**********
Saving model to :checkpoint/cifar100/base/ft_cos-ft_cos-data_init-start_0/-T_16.00-ftLR_0.100-ftEpoch_1000/session0_max_acc.pth
best epoch 3, best test acc=55.317
This epoch takes 89 seconds 
still need around 19.30 mins to finish this session
epo 4, test, loss=1.8776 acc=0.7393
********A better model is found!!**********
Saving model to :checkpoint/cifar100/base/ft_cos-ft_cos-data_init-start_0/-T_16.00-ftLR_0.100-ftEpoch_1000/session0_max_acc.pth
best epoch 4, best test acc=73.933
This epoch takes 89 seconds 
still need around 17.84 mins to finish this session
epo 5, test, loss=1.4376 acc=0.8273
********A better model is found!!**********
Saving model to :checkpoint/cifar100/base/ft_cos-ft_cos-data_init-start_0/-T_16.00-ftLR_0.100-ftEpoch_1000/session0_max_acc.pth
best epoch 5, best test acc=82.733
This epoch takes 90 seconds 
still need around 16.62 mins to finish this session
epo 6, test, loss=1.2228 acc=0.8695
********A better model is found!!**********
Saving model to :checkpoint/cifar100/base/ft_cos-ft_cos-data_init-start_0/-T_16.00-ftLR_0.100-ftEpoch_1000/session0_max_acc.pth
best epoch 6, best test acc=86.950
This epoch takes 89 seconds 
still need around 14.89 mins to finish this session
epo 7, test, loss=1.1303 acc=0.8912
********A better model is found!!**********
Saving model to :checkpoint/cifar100/base/ft_cos-ft_cos-data_init-start_0/-T_16.00-ftLR_0.100-ftEpoch_1000/session0_max_acc.pth
best epoch 7, best test acc=89.117
This epoch takes 89 seconds 
still need around 13.38 mins to finish this session
epo 8, test, loss=1.0799 acc=0.8980
********A better model is found!!**********
Saving model to :checkpoint/cifar100/base/ft_cos-ft_cos-data_init-start_0/-T_16.00-ftLR_0.100-ftEpoch_1000/session0_max_acc.pth
best epoch 8, best test acc=89.800
This epoch takes 89 seconds 
still need around 11.99 mins to finish this session
epo 9, test, loss=1.0461 acc=0.9080
********A better model is found!!**********
Saving model to :checkpoint/cifar100/base/ft_cos-ft_cos-data_init-start_0/-T_16.00-ftLR_0.100-ftEpoch_1000/session0_max_acc.pth
best epoch 9, best test acc=90.800
This epoch takes 89 seconds 
still need around 10.40 mins to finish this session
epo 10, test, loss=1.0289 acc=0.9060
********A model is found!!**********
Saving model to :checkpoint/cifar100/base/ft_cos-ft_cos-data_init-start_0/-T_16.00-ftLR_0.100-ftEpoch_1000/10.pth
best epoch 9, best test acc=90.800
This epoch takes 89 seconds 
still need around 8.96 mins to finish this session
epo 11, test, loss=1.0112 acc=0.9102
********A better model is found!!**********
Saving model to :checkpoint/cifar100/base/ft_cos-ft_cos-data_init-start_0/-T_16.00-ftLR_0.100-ftEpoch_1000/session0_max_acc.pth
best epoch 11, best test acc=91.017
This epoch takes 89 seconds 
still need around 7.49 mins to finish this session
epo 12, test, loss=1.0099 acc=0.9133
********A better model is found!!**********
Saving model to :checkpoint/cifar100/base/ft_cos-ft_cos-data_init-start_0/-T_16.00-ftLR_0.100-ftEpoch_1000/session0_max_acc.pth
best epoch 12, best test acc=91.333
This epoch takes 90 seconds 
still need around 6.04 mins to finish this session
epo 13, test, loss=1.0044 acc=0.9127
best epoch 12, best test acc=91.333
This epoch takes 82 seconds 
still need around 4.12 mins to finish this session
epo 14, test, loss=1.0029 acc=0.9142
********A better model is found!!**********
Saving model to :checkpoint/cifar100/base/ft_cos-ft_cos-data_init-start_0/-T_16.00-ftLR_0.100-ftEpoch_1000/session0_max_acc.pth
best epoch 14, best test acc=91.417
This epoch takes 89 seconds 
still need around 2.99 mins to finish this session
epo 15, test, loss=1.0034 acc=0.9140
best epoch 14, best test acc=91.417
This epoch takes 82 seconds 
still need around 1.37 mins to finish this session
Replace the fc with average embedding, and save it to :checkpoint/cifar100/base/ft_cos-ft_cos-data_init-start_0/-T_16.00-ftLR_0.100-ftEpoch_1000/session0_max_acc.pth
epo 0, test, loss=0.3015 acc=0.9112
training session: [1]
epo 0, test, loss=0.3979 acc=0.8802
Saving model to :checkpoint/cifar100/base/ft_cos-ft_cos-data_init-start_0/-T_16.00-ftLR_0.100-ftEpoch_1000/session1_max_acc.pth
  test acc=88.015
training session: [2]
epo 0, test, loss=0.4579 acc=0.8636
Saving model to :checkpoint/cifar100/base/ft_cos-ft_cos-data_init-start_0/-T_16.00-ftLR_0.100-ftEpoch_1000/session2_max_acc.pth
  test acc=86.357
training session: [3]
epo 0, test, loss=0.5477 acc=0.8404
Saving model to :checkpoint/cifar100/base/ft_cos-ft_cos-data_init-start_0/-T_16.00-ftLR_0.100-ftEpoch_1000/session3_max_acc.pth
  test acc=84.040
training session: [4]
epo 0, test, loss=0.5775 acc=0.8337
Saving model to :checkpoint/cifar100/base/ft_cos-ft_cos-data_init-start_0/-T_16.00-ftLR_0.100-ftEpoch_1000/session4_max_acc.pth
  test acc=83.375
training session: [5]
epo 0, test, loss=0.6237 acc=0.8240
Saving model to :checkpoint/cifar100/base/ft_cos-ft_cos-data_init-start_0/-T_16.00-ftLR_0.100-ftEpoch_1000/session5_max_acc.pth
  test acc=82.400
training session: [6]
epo 0, test, loss=0.6523 acc=0.8188
Saving model to :checkpoint/cifar100/base/ft_cos-ft_cos-data_init-start_0/-T_16.00-ftLR_0.100-ftEpoch_1000/session6_max_acc.pth
  test acc=81.878
training session: [7]
epo 0, test, loss=0.7000 acc=0.8077
Saving model to :checkpoint/cifar100/base/ft_cos-ft_cos-data_init-start_0/-T_16.00-ftLR_0.100-ftEpoch_1000/session7_max_acc.pth
  test acc=80.768
training session: [8]
epo 0, test, loss=0.7471 acc=0.7922
Saving model to :checkpoint/cifar100/base/ft_cos-ft_cos-data_init-start_0/-T_16.00-ftLR_0.100-ftEpoch_1000/session8_max_acc.pth
  test acc=79.220
[91.417, 88.015, 86.357, 84.04, 83.375, 82.4, 81.878, 80.768, 79.22]
Base Session Best epoch: 14
Total time used 26.47 mins
